$(document).ready(function(){$("#btn_guardar").click(function(){var e=$("#token_input").attr("value");$.ajax({url:"index.php?r=Joyeria/cotizaciones/index",data:{token:e,guardar:1},type:"GET",beforeSend:function(){$.blockUI({message:'<strong><img src="../cotizador/images/cargando.png" /> Guardando...</strong>'})},success:function(e){var e=$.parseJSON(e);1==e.error?($("#controles_cotizacion").css("display","none"),$("#mensaje_validacion_error").css("display","block"),$("#mensaje_validacion_correcto").css("display","none"),$("#mensaje_validacion_error #mensaje_valor").empty(),$("#mensaje_validacion_error #mensaje_valor").append(e.mensaje)):($("#controles_cotizacion").css("display","block"),$("#mensaje_validacion_correcto").css("display","block"),$("#mensaje_validacion_error").css("display","none"),$("#mensaje_validacion_correcto #mensaje_valor").empty(),$("#mensaje_validacion_correcto #mensaje_valor").append(e.mensaje))},error:function(){$("#controles_cotizacion").css("display","none"),smoke.alert("Ha ocurrido Error, intente más tarde",function(e){},{ok:"Aceptar",classname:"custom-class"})},complete:function(){$.unblockUI()}})}),$("#agregarProducto").click(function(){$("#mydialog").dialog("open"),$("dialog[role='dialog']").css("left","0px");var e="Productos-grid",a="#"+e+" .filters input, #"+e+" .filters select";$(a).each(function(e,a){$(a).val("")});var o=$.param($(a));return $.fn.yiiGridView.update(e,{data:o}),!1}),$("#btnPorcentajeGlobal").click(function(){if(""!=$("#porcentajeGlobal").val()){var e=$("#porcentajeGlobal").val(),a=[],o=0;$("#Cotizaciones-grid table.items tr").each(function(e){$("td",this).each(function(n){e>1&&2==n&&(a[o]=$(this).find(".idCotOculto").val(),console.log($(this).find(".idCotOculto").val()),o++)})}),$.ajax({url:"index.php?r=Joyeria/productos/seleccionProductos",data:{arrayIdCotizaciones:a,porcentajeGlobal:1,cantidadPorcentaje:e},type:"POST",success:function(e){$.fn.yiiGridView.update("Cotizaciones-grid"),alert("Porcentaje Aplicado")},error:function(){alert("Ha ocurrido un problema, intente de nuevo")}})}else alert("Debe ingresar un dígito del 1 al 100")})});